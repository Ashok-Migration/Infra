{
    "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentParameters.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "workflowName": {
            "value": "logic-cpd-apps-inttrsl-tst-we-01"
        },
        "workflowLocation": {
            "value": "westeurope"
        },
        "workflowSchema": {
            "value": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#"
        },
        "workflowTriggers": {
            "value": {
                "When_a_message_is_received_in_a_queue_(auto-complete)": {
                    "recurrence": {
                        "frequency": "Second",
                        "interval": 10
                    },
                    "type": "ApiConnection",
                    "inputs": {
                        "host": {
                            "connection": {
                                "name": "@parameters('$connections')['apicon-cpd-apps-intsb-tst-we-01']['connectionId']"
                            }
                        },
                        "method": "get",
                        "path": "/@{encodeURIComponent(encodeURIComponent('changelog'))}/messages/head",
                        "queries": {
                            "queueType": "Main"
                        }
                    }
                }
            }
        },
        "workflowActions": {
            "value": {
                "Check_For_Document_Or_Picture_Library": {
                    "actions": {
                        "Set_ListName_Append_Forms": {
                            "inputs": {
                                "name": "ListName",
                                "value": "@{concat(replace(body('Parse_Service_Bus_Message_JSON')?['ListName'],' ',''),'/Forms')}"
                            },
                            "runAfter": {},
                            "type": "SetVariable"
                        }
                    },
                    "else": {
                        "actions": {
                            "Set_ListName_Remove_Spaces": {
                                "inputs": {
                                    "name": "ListName",
                                    "value": "@{replace(body('Parse_Service_Bus_Message_JSON')?['ListName'],' ','')}"
                                },
                                "runAfter": {},
                                "type": "SetVariable"
                            }
                        }
                    },
                    "expression": {
                        "or": [
                            {
                                "equals": [
                                    "@body('Parse_Service_Bus_Message_JSON')?['ListName']",
                                    "Hero Web"
                                ]
                            },
                            {
                                "equals": [
                                    "@body('Parse_Service_Bus_Message_JSON')?['ListName']",
                                    "Hero Mobile"
                                ]
                            }
                        ]
                    },
                    "runAfter": {
                        "Parse_Items_From_Global_Level_Task_List_JSON": [
                            "Succeeded"
                        ]
                    },
                    "type": "If"
                },
                "Get_Items_From_Global_Level_Task_List": {
                    "inputs": {
                        "body": {
                            "headers": {
                                "Accept": "application/json;odata=nometadata",
                                "Content-Type": "application/json"
                            },
                            "method": "GET",
                            "uri": "/_api/web/lists/getByTitle('@{parameters('MyTasksList')}')/items?$select=ParentItemId,Id&$filter=(ParentSiteUrl eq '@{body('Parse_Service_Bus_Message_JSON')?['MarketplaceSiteURL']}' ) and (ParentItemId eq '@{body('Parse_Service_Bus_Message_JSON')?['ItemGUID']}') and TASMUTaskStatusInternal eq 'Active'"
                        },
                        "host": {
                            "connection": {
                                "name": "@parameters('$connections')['apicon-cpd-apps-intspo-tst-we-01']['connectionId']"
                            }
                        },
                        "method": "post",
                        "path": "/datasets/@{encodeURIComponent(encodeURIComponent(body('Parse_Service_Bus_Message_JSON')?['MarketplaceSiteURL']))}/httprequest"
                    },
                    "runAfter": {
                        "Get_Items_From_Task_List": [
                            "Succeeded"
                        ]
                    },
                    "type": "ApiConnection"
                },
                "Get_Items_From_Task_List": {
                    "inputs": {
                        "body": {
                            "headers": {
                                "Accept": "application/json;odata=nometadata",
                                "Content-Type": "application/json"
                            },
                            "method": "GET",
                            "uri": "/_api/web/lists/getByTitle('@{parameters('MyTasksList')}')/items?$select=ParentItemId,Id&$filter=(ParentSiteUrl eq '@{body('Parse_Service_Bus_Message_JSON')?['SiteURL']}' ) and (ParentItemId eq '@{body('Parse_Service_Bus_Message_JSON')?['ItemGUID']}') and TASMUTaskStatusInternal eq 'Active'"
                        },
                        "host": {
                            "connection": {
                                "name": "@parameters('$connections')['apicon-cpd-apps-intspo-tst-we-01']['connectionId']"
                            }
                        },
                        "method": "post",
                        "path": "/datasets/@{encodeURIComponent(encodeURIComponent(body('Parse_Service_Bus_Message_JSON')?['SiteURL']))}/httprequest"
                    },
                    "runAfter": {
                        "Parse_Service_Bus_Message_JSON": [
                            "Succeeded"
                        ]
                    },
                    "type": "ApiConnection"
                },
                "If_Task_List_And_Global_Task_List_Has_Items": {
                    "actions": {
                        "Create_Task_In_MyTasks_For_Translation": {
                            "inputs": {
                                "body": {
                                    "body": "{\n\"Title\":\"Translation Task - @{body('Parse_Service_Bus_Message_JSON')?['ItemTitle']}\",\n\"cmsAssignedToUserId\": @{variables('TranslatorsUserId')},\n\"ParentSiteUrl\":\"@{body('Parse_Service_Bus_Message_JSON')?['SiteURL']}\",\n\"ParentItemId\":\"@{body('Parse_Service_Bus_Message_JSON')?['ItemGUID']}\",\n\"TASMUTaskStatusInternal\":\"Active\",\n\"ContentTypeId\":\"@{variables('TranslationContentTypeId')}\",\n\"ParentItemLink\": {'Description': '', 'Url': '@{body('Parse_Service_Bus_Message_JSON')?['SiteURL']}/Lists/@{variables('ListName')}/DispForm.aspx?ID=@{body('Parse_Service_Bus_Message_JSON')?['ItemId']}'}\n}",
                                    "headers": {
                                        "Accept": "application/json;odata=nometadata",
                                        "Content-Type": "application/json"
                                    },
                                    "method": "POST",
                                    "uri": "/_api/web/lists/GetByTitle('@{parameters('MyTasksList')}')/items?$select=Id"
                                },
                                "host": {
                                    "connection": {
                                        "name": "@parameters('$connections')['apicon-cpd-apps-intspo-tst-we-01']['connectionId']"
                                    }
                                },
                                "method": "post",
                                "path": "/datasets/@{encodeURIComponent(encodeURIComponent(body('Parse_Service_Bus_Message_JSON')?['SiteURL']))}/httprequest"
                            },
                            "runAfter": {
                                "Loop_To_Get_TranslationContentTypeId": [
                                    "Succeeded"
                                ]
                            },
                            "type": "ApiConnection"
                        },
                        "Delay_5_Seconds_After_Finish_Translation": {
                            "inputs": {
                                "interval": {
                                    "count": 5,
                                    "unit": "Second"
                                }
                            },
                            "runAfter": {
                                "Until_Task_Status_Is_Set_Finish_Translation": [
                                    "Succeeded"
                                ]
                            },
                            "type": "Wait"
                        },
                        "Delay_5_Seconds_After_Start_Translation": {
                            "inputs": {
                                "interval": {
                                    "count": 5,
                                    "unit": "Second"
                                }
                            },
                            "runAfter": {
                                "Until_Task_Status_Is_Start_Translation": [
                                    "Succeeded"
                                ]
                            },
                            "type": "Wait"
                        },
                        "Get_ContentTypeID_For_Translation_Task": {
                            "inputs": {
                                "body": {
                                    "headers": {
                                        "Accept": "application/json;odata=nometadata",
                                        "Content-Type": "application/json"
                                    },
                                    "method": "GET",
                                    "uri": "/_api/web/Lists/getbytitle('@{parameters('MyTasksList')}')/contenttypes?$filter=Name eq 'TASMU Translation Tasks'&$top=1&$select=StringId"
                                },
                                "host": {
                                    "connection": {
                                        "name": "@parameters('$connections')['apicon-cpd-apps-intspo-tst-we-01']['connectionId']"
                                    }
                                },
                                "method": "post",
                                "path": "/datasets/@{encodeURIComponent(encodeURIComponent(body('Parse_Service_Bus_Message_JSON')?['SiteURL']))}/httprequest"
                            },
                            "runAfter": {
                                "Loop_For_Adding_Users_To_Variable": [
                                    "Succeeded"
                                ]
                            },
                            "type": "ApiConnection"
                        },
                        "Get_List_Columns_for_Auto_Translation": {
                            "inputs": {
                                "body": {
                                    "headers": {
                                        "Accept": "application/json;odata=nometadata",
                                        "Content-Type": "application/json"
                                    },
                                    "method": "GET",
                                    "uri": "/_api/web/lists/getbytitle('@{parameters('TranslateConfigListName')}')/items?$select=EngColumnName,ArColumnName,TextType&$filter=ListName eq '@{body('Parse_Service_Bus_Message_JSON')?['ListName']}'"
                                },
                                "host": {
                                    "connection": {
                                        "name": "@parameters('$connections')['apicon-cpd-apps-intspo-tst-we-01']['connectionId']"
                                    }
                                },
                                "method": "post",
                                "path": "/datasets/@{encodeURIComponent(encodeURIComponent(body('Parse_Service_Bus_Message_JSON')?['GlobalSiteURL']))}/httprequest"
                            },
                            "runAfter": {
                                "Update_Item_Status_To_Pending_Translation": [
                                    "Succeeded"
                                ]
                            },
                            "type": "ApiConnection"
                        },
                        "Get_Translators_Approvers_Group_From_Config": {
                            "inputs": {
                                "body": {
                                    "headers": {
                                        "Accept": "application/json;odata=nometadata",
                                        "Content-Type": "application/json"
                                    },
                                    "method": "GET",
                                    "uri": "/_api/web/lists/getByTitle('@{body('Parse_Service_Bus_Message_JSON')?['GlobalConfigList']}')/items?$filter=SiteURL eq '@{body('Parse_Service_Bus_Message_JSON')?['SiteURL']}'"
                                },
                                "host": {
                                    "connection": {
                                        "name": "@parameters('$connections')['apicon-cpd-apps-intspo-tst-we-01']['connectionId']"
                                    }
                                },
                                "method": "post",
                                "path": "/datasets/@{encodeURIComponent(encodeURIComponent(body('Parse_Service_Bus_Message_JSON')?['GlobalSiteURL']))}/httprequest"
                            },
                            "runAfter": {},
                            "type": "ApiConnection"
                        },
                        "Get_Users_From_Translators_Group": {
                            "inputs": {
                                "body": {
                                    "headers": {
                                        "Accept": "application/json;odata=nometadata",
                                        "Content-Type": "application/json"
                                    },
                                    "method": "GET",
                                    "uri": "/_api/web/SiteGroups/GetByName('@{first(body('Parse_Translators_Approvers_Group_From_Config_JSON')?['value'])?['Translators']}')/users?$select=Email,Id"
                                },
                                "host": {
                                    "connection": {
                                        "name": "@parameters('$connections')['apicon-cpd-apps-intspo-tst-we-01']['connectionId']"
                                    }
                                },
                                "method": "post",
                                "path": "/datasets/@{encodeURIComponent(encodeURIComponent(body('Parse_Service_Bus_Message_JSON')?['SiteURL']))}/httprequest"
                            },
                            "runAfter": {
                                "Parse_Translators_Approvers_Group_From_Config_JSON": [
                                    "Succeeded"
                                ]
                            },
                            "type": "ApiConnection"
                        },
                        "If_Task_Status_Is_Finish_Translation": {
                            "actions": {
                                "Send_an_email_(V2)_Translation_Completed": {
                                    "inputs": {
                                        "body": {
                                            "Body": "<p>@{variables('EmailBody')}</p>",
                                            "Subject": "Translation Completed - @{body('Parse_Service_Bus_Message_JSON')?['ItemTitle']}",
                                            "To": "@variables('TranslatorsEmail')"
                                        },
                                        "host": {
                                            "connection": {
                                                "name": "@parameters('$connections')['apicon-cpd-apps-into365-tst-we-01']['connectionId']"
                                            }
                                        },
                                        "method": "post",
                                        "path": "/v2/Mail"
                                    },
                                    "runAfter": {
                                        "Set_EditorEmailBody_Translation_Completed": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "ApiConnection"
                                },
                                "Send_an_email_(V2)_Translation_Completed_Notification": {
                                    "inputs": {
                                        "body": {
                                            "Body": "<p>@{variables('EditorEmailBody')}</p>",
                                            "Subject": "Translation Completed - @{body('Parse_Service_Bus_Message_JSON')?['ItemTitle']}",
                                            "To": "@body('Parse_Service_Bus_Message_JSON')?['EditorEmail']"
                                        },
                                        "host": {
                                            "connection": {
                                                "name": "@parameters('$connections')['apicon-cpd-apps-into365-tst-we-01']['connectionId']"
                                            }
                                        },
                                        "method": "post",
                                        "path": "/v2/Mail"
                                    },
                                    "runAfter": {
                                        "Send_an_email_(V2)_Translation_Completed": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "ApiConnection"
                                },
                                "Send_message_For_1st_Level_Approval_Queue": {
                                    "inputs": {
                                        "body": {
                                            "ContentData": "@{base64(concat('{','\n','\"SiteURL\": \"',body('Parse_Service_Bus_Message_JSON')?['SiteURL'],'\",','\n','\"ItemTitle\": \"',body('Parse_Service_Bus_Message_JSON')?['ItemTitle'],'\",','\n','\"ItemGUID\": \"',body('Parse_Service_Bus_Message_JSON')?['ItemGUID'],'\",','\n','\"ItemId\": \"',body('Parse_Service_Bus_Message_JSON')?['ItemId'],'\",','\n','\"ListName\": \"',body('Parse_Service_Bus_Message_JSON')?['ListName'],'\",','\n','\"EditorEmail\": \"',body('Parse_Service_Bus_Message_JSON')?['EditorEmail'],'\",','\n','\"TranslatorId\": \"',body('Parse_Users_Task_For_Translation_JSON')?['ID'],'\",','\n','\"Sensitivity\": \"',body('Parse_Service_Bus_Message_JSON')?['Sensitivity'],'\",','\n','\"MarketplaceSiteURL\": \"',body('Parse_Service_Bus_Message_JSON')?['MarketplaceSiteURL'],'\",','\n','\"GlobalSiteURL\": \"',body('Parse_Service_Bus_Message_JSON')?['GlobalSiteURL'],'\",','\n','\"GlobalConfigList\": \"',body('Parse_Service_Bus_Message_JSON')?['GlobalConfigList'],'\"','\n','}'))}"
                                        },
                                        "host": {
                                            "connection": {
                                                "name": "@parameters('$connections')['apicon-cpd-apps-intsb-tst-we-01']['connectionId']"
                                            }
                                        },
                                        "method": "post",
                                        "path": "/@{encodeURIComponent(encodeURIComponent('approval'))}/messages",
                                        "queries": {
                                            "systemProperties": "None"
                                        }
                                    },
                                    "runAfter": {
                                        "Send_an_email_(V2)_Translation_Completed_Notification": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "ApiConnection"
                                },
                                "Set_EditorEmailBody_Translation_Completed": {
                                    "inputs": {
                                        "name": "EditorEmailBody",
                                        "value": "<p>Hello Editor,\n<br><br>\nPlease note , <b>\"@{body('Parse_Service_Bus_Message_JSON')?['ItemTitle']}\"</b> item has been translated.\n<br><br>\nRegards,<br>\nAdmin Team</p>"
                                    },
                                    "runAfter": {
                                        "Set_EmailBody_Translation_Completed": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "SetVariable"
                                },
                                "Set_EmailBody_Translation_Completed": {
                                    "inputs": {
                                        "name": "EmailBody",
                                        "value": "<p>Hello Translator,\n<br><br>\nPlease note , <b>\"@{body('Parse_Service_Bus_Message_JSON')?['ItemTitle']}\"</b> item has been translated.\n<br><br>\nPlease visit item <a href=\"@{body('Parse_Service_Bus_Message_JSON')?['SiteURL']}/Lists/@{variables('ListName')}/EditForm.aspx?ID=@{body('Parse_Service_Bus_Message_JSON')?['ItemId']}\">Link</a> to view the translated content. \n<br><br>\nRegards,<br>\nAdmin Team</p>"
                                    },
                                    "runAfter": {
                                        "Update_Task_Status_And_Comments": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "SetVariable"
                                },
                                "Update_Task_Internal_Status_To_Active": {
                                    "inputs": {
                                        "body": {
                                            "body": "{\n\"TASMUTaskStatusInternal\":\"Active\"\n}",
                                            "headers": {
                                                "Accept": "application/json;odata=verbose",
                                                "Content-Type": "application/json",
                                                "If-Match": "*",
                                                "X-HTTP-Method": "MERGE"
                                            },
                                            "method": "POST",
                                            "uri": "/_api/web/lists/GetByTitle('@{parameters('MyTasksList')}')/GetItemById(@{body('Parse_Users_Task_For_Translation_JSON')?['ID']})"
                                        },
                                        "host": {
                                            "connection": {
                                                "name": "@parameters('$connections')['apicon-cpd-apps-intspo-tst-we-01']['connectionId']"
                                            }
                                        },
                                        "method": "post",
                                        "path": "/datasets/@{encodeURIComponent(encodeURIComponent(body('Parse_Service_Bus_Message_JSON')?['SiteURL']))}/httprequest"
                                    },
                                    "runAfter": {},
                                    "type": "ApiConnection"
                                },
                                "Update_Task_Status_And_Comments": {
                                    "inputs": {
                                        "body": {
                                            "body": "{\n\"ApproverComments\":\"@{variables('TranslatorTaskComments')}\",\n\"RequiresTranslation\":\"False\",\n\"ContentStatus\":\"Translated\"\n}",
                                            "headers": {
                                                "Accept": "application/json;odata=verbose",
                                                "Content-Type": "application/json",
                                                "If-Match": "*",
                                                "X-HTTP-Method": "MERGE"
                                            },
                                            "method": "POST",
                                            "uri": "/_api/web/lists/GetByTitle('@{body('Parse_Service_Bus_Message_JSON')?['ListName']}')/GetItemById(@{body('Parse_Service_Bus_Message_JSON')?['ItemId']})"
                                        },
                                        "host": {
                                            "connection": {
                                                "name": "@parameters('$connections')['apicon-cpd-apps-intspo-tst-we-01']['connectionId']"
                                            }
                                        },
                                        "method": "post",
                                        "path": "/datasets/@{encodeURIComponent(encodeURIComponent(body('Parse_Service_Bus_Message_JSON')?['SiteURL']))}/httprequest"
                                    },
                                    "runAfter": {
                                        "Update_Task_Internal_Status_To_Active": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "ApiConnection"
                                }
                            },
                            "else": {
                                "actions": {
                                    "Set_the_Status_To_Rejected": {
                                        "inputs": {
                                            "body": {
                                                "body": "{\n\"TASMUTaskStatusInternal\":\"Rejected\",\n\"TASMUTaskStatus\":\"Rejected\"\n}",
                                                "headers": {
                                                    "Accept": "application/json;odata=verbose",
                                                    "Content-Type": "application/json",
                                                    "If-Match": "*",
                                                    "X-HTTP-Method": "MERGE"
                                                },
                                                "method": "POST",
                                                "uri": "/_api/web/lists/GetByTitle('@{parameters('MyTasksList')}')/GetItemById(@{body('Parse_Users_Task_For_Translation_JSON')?['ID']})"
                                            },
                                            "host": {
                                                "connection": {
                                                    "name": "@parameters('$connections')['apicon-cpd-apps-intspo-tst-we-01']['connectionId']"
                                                }
                                            },
                                            "method": "post",
                                            "path": "/datasets/@{encodeURIComponent(encodeURIComponent(body('Parse_Service_Bus_Message_JSON')?['SiteURL']))}/httprequest"
                                        },
                                        "runAfter": {},
                                        "type": "ApiConnection"
                                    }
                                }
                            },
                            "expression": {
                                "or": [
                                    {
                                        "equals": [
                                            "@variables('TranslatorTaskStatus')",
                                            "Finish Translation"
                                        ]
                                    }
                                ]
                            },
                            "runAfter": {
                                "If_Task_Status_is_Start_Translation_Then_Reassign": [
                                    "Succeeded"
                                ],
                                "Set_FinishTranslationReminder": [
                                    "Succeeded"
                                ]
                            },
                            "type": "If"
                        },
                        "If_Task_Status_is_Start_Translation_Then_Reassign": {
                            "actions": {
                                "Reassign_Task_To_One_Translator": {
                                    "inputs": {
                                        "body": {
                                            "body": "{\n\"cmsAssignedToUserId\":[@{variables('TranslationOwnershipEmail')}]\n}",
                                            "headers": {
                                                "Accept": "application/json;odata=nometadata",
                                                "Content-Type": "application/json",
                                                "If-Match": "*",
                                                "X-HTTP-Method": "MERGE"
                                            },
                                            "method": "POST",
                                            "uri": "/_api/web/lists/GetByTitle('@{parameters('MyTasksList')}')/GetItemById(@{body('Parse_Users_Task_For_Translation_JSON')?['ID']})"
                                        },
                                        "host": {
                                            "connection": {
                                                "name": "@parameters('$connections')['apicon-cpd-apps-intspo-tst-we-01']['connectionId']"
                                            }
                                        },
                                        "method": "post",
                                        "path": "/datasets/@{encodeURIComponent(encodeURIComponent(body('Parse_Service_Bus_Message_JSON')?['SiteURL']))}/httprequest"
                                    },
                                    "runAfter": {},
                                    "type": "ApiConnection"
                                }
                            },
                            "expression": {
                                "and": [
                                    {
                                        "equals": [
                                            "@variables('TranslationOwnership')",
                                            "Start Translation"
                                        ]
                                    }
                                ]
                            },
                            "runAfter": {
                                "Set_StartTranslationReminder": [
                                    "Succeeded"
                                ]
                            },
                            "type": "If"
                        },
                        "If_there_are_any_columns_for_auto_translation": {
                            "actions": {
                                "Final_TranslationColumnString": {
                                    "inputs": "@substring(variables('TranslateColumnsString'),0,sub(length(variables('TranslateColumnsString')),1))",
                                    "runAfter": {
                                        "Until_Loop_to_set_TranslationColumnString": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "Compose"
                                },
                                "Get_Column_Data_for_AutoTranslation": {
                                    "inputs": {
                                        "body": {
                                            "headers": {
                                                "Accept": "application/json;odata=nometadata",
                                                "Content-Type": "application/json"
                                            },
                                            "method": "GET",
                                            "uri": "/_api/web/lists/getbytitle('@{body('Parse_Service_Bus_Message_JSON')?['ListName']}')/items(@{body('Parse_Service_Bus_Message_JSON')?['ItemId']})?$select=@{outputs('Final_TranslationColumnString')}"
                                        },
                                        "host": {
                                            "connection": {
                                                "name": "@parameters('$connections')['apicon-cpd-apps-intspo-tst-we-01']['connectionId']"
                                            }
                                        },
                                        "method": "post",
                                        "path": "/datasets/@{encodeURIComponent(encodeURIComponent(body('Parse_Service_Bus_Message_JSON')?['SiteURL']))}/httprequest"
                                    },
                                    "runAfter": {
                                        "Final_TranslationColumnString": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "ApiConnection"
                                },
                                "Send_Arabic_translated_data_of_plain_type_to_sharepoint": {
                                    "inputs": {
                                        "body": {
                                            "body": "@{variables('TranslatedObject')}",
                                            "headers": {
                                                "Accept": "application/json;odata=verbose",
                                                "Content-Type": "application/json",
                                                "If-Match": "*",
                                                "X-HTTP-Method": "MERGE"
                                            },
                                            "method": "POST",
                                            "uri": "/_api/web/lists/GetByTitle('@{body('Parse_Service_Bus_Message_JSON')?['ListName']}')/GetItemById(@{body('Parse_Service_Bus_Message_JSON')?['ItemId']})"
                                        },
                                        "host": {
                                            "connection": {
                                                "name": "@parameters('$connections')['apicon-cpd-apps-intspo-tst-we-01']['connectionId']"
                                            }
                                        },
                                        "method": "post",
                                        "path": "/datasets/@{encodeURIComponent(encodeURIComponent(body('Parse_Service_Bus_Message_JSON')?['SiteURL']))}/httprequest"
                                    },
                                    "runAfter": {
                                        "Until_AutoTranslation_is_done": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "ApiConnection"
                                },
                                "Set_IncrementVariable_to_0": {
                                    "inputs": {
                                        "name": "IncrementVariableForUntilLoop",
                                        "value": 0
                                    },
                                    "runAfter": {
                                        "Get_Column_Data_for_AutoTranslation": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "SetVariable"
                                },
                                "Set_TranslatedObject": {
                                    "inputs": {
                                        "name": "TranslatedObject",
                                        "value": {}
                                    },
                                    "runAfter": {
                                        "Set_IncrementVariable_to_0": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "SetVariable"
                                },
                                "Until_AutoTranslation_is_done": {
                                    "actions": {
                                        "ArabicColumnData": {
                                            "inputs": "@body('Get_column_data_for_AutoTranslation')?[outputs('ArabicColumnName')]",
                                            "runAfter": {
                                                "EnglishColumnData": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "Compose"
                                        },
                                        "ArabicColumnName": {
                                            "inputs": "@body('Parse_List_Columns_for_auto_translation')?['value'][variables('IncrementVariableForUntilLoop')]?['ArColumnName']",
                                            "runAfter": {
                                                "EnglishColumnName": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "Compose"
                                        },
                                        "EnglishColumnData": {
                                            "inputs": "@body('Get_column_data_for_AutoTranslation')?[outputs('EnglishColumnName')]",
                                            "runAfter": {
                                                "TextTypeOfColumn": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "Compose"
                                        },
                                        "EnglishColumnName": {
                                            "inputs": "@body('Parse_List_Columns_for_auto_translation')?['value'][variables('IncrementVariableForUntilLoop')]?['EngColumnName']",
                                            "runAfter": {},
                                            "type": "Compose"
                                        },
                                        "If_Arabic_Column_is_empty": {
                                            "actions": {
                                                "Check_column_text_type": {
                                                    "actions": {
                                                        "Compose_set_and_add_property_for_Translation_plain_text_object": {
                                                            "inputs": "@addProperty(variables('TranslatedObject'),outputs('ArabicColumnName'),variables('TranslatedPlain'))",
                                                            "runAfter": {
                                                                "Set_variable_TranslatedPlain": [
                                                                    "Succeeded",
                                                                    "Failed"
                                                                ]
                                                            },
                                                            "type": "Compose"
                                                        },
                                                        "Set_TranslatedPlain_to_empty_string": {
                                                            "inputs": {
                                                                "name": "TranslatedPlain",
                                                                "value": "@{trim('')}"
                                                            },
                                                            "runAfter": {
                                                                "Compose_set_and_add_property_for_Translation_plain_text_object": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable"
                                                        },
                                                        "Set_Translated_Plain_text_object": {
                                                            "inputs": {
                                                                "name": "TranslatedObject",
                                                                "value": "@outputs('Compose_set_and_add_property_for_Translation_plain_text_object')"
                                                            },
                                                            "runAfter": {
                                                                "Set_TranslatedPlain_to_empty_string": [
                                                                    "Succeeded"
                                                                ]
                                                            },
                                                            "type": "SetVariable"
                                                        },
                                                        "Set_variable_TranslatedPlain": {
                                                            "inputs": {
                                                                "name": "TranslatedPlain",
                                                                "value": "@body('Translate_plain_text_type')"
                                                            },
                                                            "runAfter": {
                                                                "Translate_plain_text_type": [
                                                                    "Succeeded",
                                                                    "Failed"
                                                                ]
                                                            },
                                                            "type": "SetVariable"
                                                        },
                                                        "Translate_plain_text_type": {
                                                            "inputs": {
                                                                "body": {
                                                                    "Text": "@{outputs('EnglishColumnData')}"
                                                                },
                                                                "host": {
                                                                    "connection": {
                                                                        "name": "@parameters('$connections')['apicon-cpd-apps-intcog-tst-we-01']['connectionId']"
                                                                    }
                                                                },
                                                                "method": "post",
                                                                "path": "/Translate",
                                                                "queries": {
                                                                    "to": "ar"
                                                                }
                                                            },
                                                            "runAfter": {},
                                                            "type": "ApiConnection"
                                                        }
                                                    },
                                                    "else": {
                                                        "actions": {
                                                            "Send_enriched_text_html_translated_data_to_sharepoint": {
                                                                "inputs": {
                                                                    "body": {
                                                                        "body": "{\"@{outputs('ArabicColumnName')}\":'@{replace(variables('TranslatedHTML'),'''','&apos;')}'}",
                                                                        "headers": {
                                                                            "Accept": "application/json;odata=verbose",
                                                                            "Content-Type": "application/json",
                                                                            "If-Match": "*",
                                                                            "X-HTTP-Method": "MERGE"
                                                                        },
                                                                        "method": "POST",
                                                                        "uri": "/_api/web/lists/GetByTitle('@{body('Parse_Service_Bus_Message_JSON')?['ListName']}')/GetItemById(@{body('Parse_Service_Bus_Message_JSON')?['ItemId']})"
                                                                    },
                                                                    "host": {
                                                                        "connection": {
                                                                            "name": "@parameters('$connections')['apicon-cpd-apps-intspo-tst-we-01']['connectionId']"
                                                                        }
                                                                    },
                                                                    "method": "post",
                                                                    "path": "/datasets/@{encodeURIComponent(encodeURIComponent(body('Parse_Service_Bus_Message_JSON')?['SiteURL']))}/httprequest"
                                                                },
                                                                "runAfter": {
                                                                    "Set_TranslatedHTML_string": [
                                                                        "Succeeded",
                                                                        "Failed"
                                                                    ]
                                                                },
                                                                "type": "ApiConnection"
                                                            },
                                                            "Set_TranslatedHTML_string": {
                                                                "inputs": {
                                                                    "name": "TranslatedHTML",
                                                                    "value": "@body('Translate_text_HTML_type')"
                                                                },
                                                                "runAfter": {
                                                                    "Translate_text_HTML_type": [
                                                                        "Succeeded",
                                                                        "Failed"
                                                                    ]
                                                                },
                                                                "type": "SetVariable"
                                                            },
                                                            "Set_TranslatedHTML_string_to_empty": {
                                                                "inputs": {
                                                                    "name": "TranslatedHTML",
                                                                    "value": "@{trim('')}"
                                                                },
                                                                "runAfter": {
                                                                    "Send_enriched_text_html_translated_data_to_sharepoint": [
                                                                        "Succeeded"
                                                                    ]
                                                                },
                                                                "type": "SetVariable"
                                                            },
                                                            "Translate_text_HTML_type": {
                                                                "inputs": {
                                                                    "body": {
                                                                        "Text": "@{trim(replace(outputs('EnglishColumnData'),'''','&apos;'))}"
                                                                    },
                                                                    "host": {
                                                                        "connection": {
                                                                            "name": "@parameters('$connections')['apicon-cpd-apps-intcog-tst-we-01']['connectionId']"
                                                                        }
                                                                    },
                                                                    "method": "post",
                                                                    "path": "/Translate",
                                                                    "queries": {
                                                                        "textType": "@{outputs('TextTypeOfColumn')}",
                                                                        "to": "ar"
                                                                    }
                                                                },
                                                                "runAfter": {},
                                                                "type": "ApiConnection"
                                                            }
                                                        }
                                                    },
                                                    "expression": {
                                                        "and": [
                                                            {
                                                                "equals": [
                                                                    "@outputs('TextTypeOfColumn')",
                                                                    "plain"
                                                                ]
                                                            }
                                                        ]
                                                    },
                                                    "runAfter": {},
                                                    "type": "If"
                                                },
                                                "Increment_variable_2": {
                                                    "inputs": {
                                                        "name": "IncrementVariableForUntilLoop",
                                                        "value": 1
                                                    },
                                                    "runAfter": {
                                                        "Check_column_text_type": [
                                                            "Succeeded"
                                                        ]
                                                    },
                                                    "type": "IncrementVariable"
                                                }
                                            },
                                            "else": {
                                                "actions": {
                                                    "Increment_variable_for_until_loop": {
                                                        "inputs": {
                                                            "name": "IncrementVariableForUntilLoop",
                                                            "value": 1
                                                        },
                                                        "runAfter": {},
                                                        "type": "IncrementVariable"
                                                    }
                                                }
                                            },
                                            "expression": {
                                                "and": [
                                                    {
                                                        "equals": [
                                                            "@body('Get_column_data_for_AutoTranslation')?[outputs('ArabicColumnName')]",
                                                            "@null"
                                                        ]
                                                    }
                                                ]
                                            },
                                            "runAfter": {
                                                "ArabicColumnData": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "If"
                                        },
                                        "TextTypeOfColumn": {
                                            "inputs": "@body('Parse_List_Columns_for_auto_translation')?['value'][variables('IncrementVariableForUntilLoop')]?['TextType']",
                                            "runAfter": {
                                                "ArabicColumnName": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "Compose"
                                        }
                                    },
                                    "expression": "@equals(variables('IncrementVariableForUntilLoop'), variables('NumberOfColumnsToTranslate'))",
                                    "limit": {
                                        "count": 60,
                                        "timeout": "PT1H"
                                    },
                                    "runAfter": {
                                        "Set_TranslatedObject": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "Until"
                                },
                                "Until_Loop_to_set_TranslationColumnString": {
                                    "actions": {
                                        "Append_to_TranslateColumnsString": {
                                            "inputs": {
                                                "name": "TranslateColumnsString",
                                                "value": "@{body('Parse_List_Columns_for_auto_translation')?['value'][variables('IncrementVariableForUntilLoop')]?['EngColumnName']},@{body('Parse_List_Columns_for_auto_translation')?['value'][variables('IncrementVariableForUntilLoop')]?['ArColumnName']},"
                                            },
                                            "runAfter": {},
                                            "type": "AppendToStringVariable"
                                        },
                                        "Increment_variable": {
                                            "inputs": {
                                                "name": "IncrementVariableForUntilLoop",
                                                "value": 1
                                            },
                                            "runAfter": {
                                                "Append_to_TranslateColumnsString": [
                                                    "Succeeded"
                                                ]
                                            },
                                            "type": "IncrementVariable"
                                        }
                                    },
                                    "expression": "@equals(variables('IncrementVariableForUntilLoop'), variables('NumberOfColumnsToTranslate'))",
                                    "limit": {
                                        "count": 60,
                                        "timeout": "PT1H"
                                    },
                                    "runAfter": {},
                                    "type": "Until"
                                }
                            },
                            "expression": {
                                "and": [
                                    {
                                        "greater": [
                                            "@variables('NumberOfColumnsToTranslate')",
                                            0
                                        ]
                                    }
                                ]
                            },
                            "runAfter": {
                                "Set_NumberOfColumnsToTranslatate": [
                                    "Succeeded"
                                ]
                            },
                            "type": "If"
                        },
                        "Loop_For_Adding_Users_To_Variable": {
                            "actions": {
                                "Append_TranslatorsEmail": {
                                    "inputs": {
                                        "name": "TranslatorsEmail",
                                        "value": "@{items('Loop_For_Adding_Users_To_Variable')?['Email']};"
                                    },
                                    "runAfter": {},
                                    "type": "AppendToStringVariable"
                                },
                                "Append_TranslatorsUserId": {
                                    "inputs": {
                                        "name": "TranslatorsUserId",
                                        "value": "@items('Loop_For_Adding_Users_To_Variable')?['Id']"
                                    },
                                    "runAfter": {
                                        "Append_TranslatorsEmail": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "AppendToArrayVariable"
                                }
                            },
                            "foreach": "@body('Parse_Users_From_Translators_Group_JSON')?['value']",
                            "runAfter": {
                                "Parse_Users_From_Translators_Group_JSON": [
                                    "Succeeded"
                                ]
                            },
                            "type": "Foreach"
                        },
                        "Loop_To_Get_TranslationContentTypeId": {
                            "actions": {
                                "Set_TranslationContentTypeId": {
                                    "inputs": {
                                        "name": "TranslationContentTypeId",
                                        "value": "@items('Loop_To_Get_TranslationContentTypeId')?['StringId']"
                                    },
                                    "runAfter": {},
                                    "type": "SetVariable"
                                }
                            },
                            "foreach": "@body('Parse_ContentTypeID_For_Translation_Task_JSON')?['value']",
                            "runAfter": {
                                "Parse_ContentTypeID_For_Translation_Task_JSON": [
                                    "Succeeded"
                                ]
                            },
                            "type": "Foreach"
                        },
                        "Parse_ContentTypeID_For_Translation_Task_JSON": {
                            "inputs": {
                                "content": "@body('Get_ContentTypeID_For_Translation_Task')",
                                "schema": {
                                    "properties": {
                                        "value": {
                                            "items": {
                                                "properties": {
                                                    "StringId": {
                                                        "type": "string"
                                                    }
                                                },
                                                "required": [
                                                    "StringId"
                                                ],
                                                "type": "object"
                                            },
                                            "type": "array"
                                        }
                                    },
                                    "type": "object"
                                }
                            },
                            "runAfter": {
                                "Get_ContentTypeID_For_Translation_Task": [
                                    "Succeeded"
                                ]
                            },
                            "type": "ParseJson"
                        },
                        "Parse_List_Columns_for_auto_translation": {
                            "inputs": {
                                "content": "@body('Get_List_Columns_for_Auto_Translation')",
                                "schema": {
                                    "properties": {
                                        "value": {
                                            "items": {
                                                "properties": {
                                                    "ArColumnName": {
                                                        "type": "string"
                                                    },
                                                    "EngColumnName": {
                                                        "type": "string"
                                                    },
                                                    "TextType": {
                                                        "type": "string"
                                                    }
                                                },
                                                "required": [
                                                    "EngColumnName",
                                                    "ArColumnName",
                                                    "TextType"
                                                ],
                                                "type": "object"
                                            },
                                            "type": "array"
                                        }
                                    },
                                    "type": "object"
                                }
                            },
                            "runAfter": {
                                "Get_List_Columns_for_Auto_Translation": [
                                    "Succeeded"
                                ]
                            },
                            "type": "ParseJson"
                        },
                        "Parse_Translators_Approvers_Group_From_Config_JSON": {
                            "inputs": {
                                "content": "@body('Get_Translators_Approvers_Group_From_Config')",
                                "schema": {
                                    "properties": {
                                        "value": {
                                            "items": {
                                                "properties": {
                                                    "Approvers": {
                                                        "type": "string"
                                                    },
                                                    "CriticalApprovers": {
                                                        "type": [
                                                            "string",
                                                            "null"
                                                        ]
                                                    },
                                                    "Id": {
                                                        "type": "integer"
                                                    },
                                                    "SiteLevel": {
                                                        "type": "string"
                                                    },
                                                    "SiteURL": {
                                                        "type": "string"
                                                    },
                                                    "Translators": {
                                                        "type": "string"
                                                    }
                                                },
                                                "type": "object"
                                            },
                                            "type": "array"
                                        }
                                    },
                                    "type": "object"
                                }
                            },
                            "runAfter": {
                                "Get_Translators_Approvers_Group_From_Config": [
                                    "Succeeded"
                                ]
                            },
                            "type": "ParseJson"
                        },
                        "Parse_Users_From_Translators_Group_JSON": {
                            "inputs": {
                                "content": "@body('Get_Users_From_Translators_Group')",
                                "schema": {
                                    "properties": {
                                        "value": {
                                            "items": {
                                                "properties": {
                                                    "Email": {
                                                        "type": "string"
                                                    },
                                                    "Id": {
                                                        "type": "integer"
                                                    }
                                                },
                                                "required": [
                                                    "Id",
                                                    "Email"
                                                ],
                                                "type": "object"
                                            },
                                            "type": "array"
                                        }
                                    },
                                    "type": "object"
                                }
                            },
                            "runAfter": {
                                "Get_Users_From_Translators_Group": [
                                    "Succeeded"
                                ]
                            },
                            "type": "ParseJson"
                        },
                        "Parse_Users_Task_For_Translation_JSON": {
                            "inputs": {
                                "content": "@body('Create_Task_In_MyTasks_For_Translation')",
                                "schema": {
                                    "properties": {
                                        "ID": {
                                            "type": "integer"
                                        },
                                        "Id": {
                                            "type": "integer"
                                        }
                                    },
                                    "type": "object"
                                }
                            },
                            "runAfter": {
                                "Create_Task_In_MyTasks_For_Translation": [
                                    "Succeeded"
                                ]
                            },
                            "type": "ParseJson"
                        },
                        "Send_an_email_(V2)_Translation_Request": {
                            "inputs": {
                                "body": {
                                    "Body": "<p>@{variables('EmailBody')}</p>",
                                    "Importance": "High",
                                    "Subject": "Translation Request - @{body('Parse_Service_Bus_Message_JSON')?['ItemTitle']}",
                                    "To": "@variables('TranslatorsEmail')"
                                },
                                "host": {
                                    "connection": {
                                        "name": "@parameters('$connections')['apicon-cpd-apps-into365-tst-we-01']['connectionId']"
                                    }
                                },
                                "method": "post",
                                "path": "/v2/Mail"
                            },
                            "runAfter": {
                                "Set_EditorEmailBody_Translation_Request_Notification": [
                                    "Succeeded"
                                ]
                            },
                            "type": "ApiConnection"
                        },
                        "Send_an_email_(V2)_Translation_Request_Notification": {
                            "inputs": {
                                "body": {
                                    "Body": "<p>@{variables('EditorEmailBody')}</p>",
                                    "Subject": "Translation Request- @{body('Parse_Service_Bus_Message_JSON')?['ItemTitle']}",
                                    "To": "@body('Parse_Service_Bus_Message_JSON')?['EditorEmail']"
                                },
                                "host": {
                                    "connection": {
                                        "name": "@parameters('$connections')['apicon-cpd-apps-into365-tst-we-01']['connectionId']"
                                    }
                                },
                                "method": "post",
                                "path": "/v2/Mail"
                            },
                            "runAfter": {
                                "Send_an_email_(V2)_Translation_Request": [
                                    "Succeeded"
                                ]
                            },
                            "type": "ApiConnection"
                        },
                        "Set_EditorEmailBody_Translation_Request_Notification": {
                            "inputs": {
                                "name": "EditorEmailBody",
                                "value": "<p>Hello Editor,\n<br><br>\nPlease note , <b>\"@{body('Parse_Service_Bus_Message_JSON')?['ItemTitle']}\"</b> item has been received for translation.\n<br><br>\nRegards,<br>\nAdmin Team</p>"
                            },
                            "runAfter": {
                                "Set_EmailBody_Translation_Request": [
                                    "Succeeded"
                                ]
                            },
                            "type": "SetVariable"
                        },
                        "Set_EmailBody_Translation_Request": {
                            "inputs": {
                                "name": "EmailBody",
                                "value": "<p>Hello Translator,\n<br /><br />\nPlease note , <b>\"@{body('Parse_Service_Bus_Message_JSON')?['ItemTitle']}\"</b> item has been received for translation.\n<br>\nPlease visit Item <a href=\"@{body('Parse_Service_Bus_Message_JSON')?['SiteURL']}/Lists/@{variables('ListName')}/EditForm.aspx?ID=@{body('Parse_Service_Bus_Message_JSON')?['ItemId']}\">Link</a> to review or update translation.\n<br>\nClick <a href=\"@{body('Parse_Service_Bus_Message_JSON')?['SiteURL']}/Lists/MyTasks/EditForm.aspx?ID=@{body('Parse_Users_Task_For_Translation_JSON')?['ID']}\">here</a> to view the task.\n<br><br>\nRegards,<br>\nAdmin Team</p>"
                            },
                            "runAfter": {
                                "If_there_are_any_columns_for_auto_translation": [
                                    "Succeeded"
                                ]
                            },
                            "type": "SetVariable"
                        },
                        "Set_FinishTranslationReminder": {
                            "inputs": {
                                "name": "FinishTranslationReminder",
                                "value": "@false"
                            },
                            "runAfter": {
                                "Set_TranslationOwnershipCompleted_Finish_Translation": [
                                    "Succeeded"
                                ]
                            },
                            "type": "SetVariable"
                        },
                        "Set_NumberOfColumnsToTranslatate": {
                            "inputs": {
                                "name": "NumberOfColumnsToTranslate",
                                "value": "@length(body('Parse_List_Columns_for_auto_translation')?['value'])"
                            },
                            "runAfter": {
                                "Parse_List_Columns_for_auto_translation": [
                                    "Succeeded"
                                ]
                            },
                            "type": "SetVariable"
                        },
                        "Set_StartTranslationReminder": {
                            "inputs": {
                                "name": "StartTranslationReminder",
                                "value": "@false"
                            },
                            "runAfter": {
                                "Set_TranslationOwnershipCompleted_Start_Translation": [
                                    "Succeeded"
                                ]
                            },
                            "type": "SetVariable"
                        },
                        "Set_TranslationOwnershipCompleted_Finish_Translation": {
                            "inputs": {
                                "name": "TranslationOwnershipCompleted",
                                "value": "Yes"
                            },
                            "runAfter": {
                                "Delay_5_Seconds_After_Finish_Translation": [
                                    "Succeeded"
                                ]
                            },
                            "type": "SetVariable"
                        },
                        "Set_TranslationOwnershipCompleted_Start_Translation": {
                            "inputs": {
                                "name": "TranslationOwnershipCompleted",
                                "value": "Yes"
                            },
                            "runAfter": {
                                "Delay_5_Seconds_After_Start_Translation": [
                                    "Succeeded"
                                ]
                            },
                            "type": "SetVariable"
                        },
                        "Until_Task_Status_Is_Finish_Translation_Reminder": {
                            "actions": {
                                "Delay_1_Day_Finish_Translation_Reminder": {
                                    "inputs": {
                                        "interval": {
                                            "count": 1,
                                            "unit": "Day"
                                        }
                                    },
                                    "runAfter": {},
                                    "type": "Wait"
                                },
                                "If_Task_Status_Is_Finish_Translation_Reminder": {
                                    "actions": {
                                        "Send_an_email_(V2)_Finish_Translation_Reminder": {
                                            "inputs": {
                                                "body": {
                                                    "Body": "<p>@{variables('EmailBody')}</p>",
                                                    "Subject": "Gentle Reminder-Translation Request - @{body('Parse_Service_Bus_Message_JSON')?['ItemTitle']}",
                                                    "To": "@variables('TranslatorsEmail')"
                                                },
                                                "host": {
                                                    "connection": {
                                                        "name": "@parameters('$connections')['apicon-cpd-apps-into365-tst-we-01']['connectionId']"
                                                    }
                                                },
                                                "method": "post",
                                                "path": "/v2/Mail"
                                            },
                                            "runAfter": {},
                                            "type": "ApiConnection"
                                        }
                                    },
                                    "expression": {
                                        "or": [
                                            {
                                                "equals": [
                                                    "@variables('FinishTranslationReminder')",
                                                    "@true"
                                                ]
                                            }
                                        ]
                                    },
                                    "runAfter": {
                                        "Delay_1_Day_Finish_Translation_Reminder": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "If"
                                }
                            },
                            "expression": "@equals(variables('FinishTranslationReminder'), false)",
                            "limit": {
                                "count": 100,
                                "timeout": "P1M"
                            },
                            "runAfter": {
                                "Send_an_email_(V2)_Translation_Request_Notification": [
                                    "Succeeded"
                                ]
                            },
                            "type": "Until"
                        },
                        "Until_Task_Status_Is_Set_Finish_Translation": {
                            "actions": {
                                "Delay_10_Seconds_Set_Finish_Translation": {
                                    "inputs": {
                                        "interval": {
                                            "count": 10,
                                            "unit": "Second"
                                        }
                                    },
                                    "runAfter": {},
                                    "type": "Wait"
                                },
                                "Get_Task_Translation_Status_-_Finish_Translation": {
                                    "inputs": {
                                        "body": {
                                            "headers": {
                                                "Accept": "application/json;odata=nometadata",
                                                "Content-Type": "application/json"
                                            },
                                            "method": "GET",
                                            "uri": "/_api/web/lists/getbytitle('@{parameters('MyTasksList')}')/items(@{body('Parse_Users_Task_For_Translation_JSON')?['ID']})?$select=TASMUTaskStatusInternal,TaskComments,TASMUTaskStatus,Translation"
                                        },
                                        "host": {
                                            "connection": {
                                                "name": "@parameters('$connections')['apicon-cpd-apps-intspo-tst-we-01']['connectionId']"
                                            }
                                        },
                                        "method": "post",
                                        "path": "/datasets/@{encodeURIComponent(encodeURIComponent(body('Parse_Service_Bus_Message_JSON')?['SiteURL']))}/httprequest"
                                    },
                                    "runAfter": {
                                        "Delay_10_Seconds_Set_Finish_Translation": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "ApiConnection"
                                },
                                "Parse_Task_Translation_Status_JSON": {
                                    "inputs": {
                                        "content": "@body('Get_Task_Translation_Status_-_Finish_Translation')",
                                        "schema": {
                                            "properties": {
                                                "TASMUTaskStatus": {
                                                    "type": [
                                                        "string",
                                                        "null"
                                                    ]
                                                },
                                                "TASMUTaskStatusInternal": {
                                                    "type": [
                                                        "string",
                                                        "null"
                                                    ]
                                                },
                                                "TaskComments": {
                                                    "type": [
                                                        "string",
                                                        "null"
                                                    ]
                                                },
                                                "Translation": {
                                                    "type": [
                                                        "string",
                                                        "null"
                                                    ]
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "runAfter": {
                                        "Get_Task_Translation_Status_-_Finish_Translation": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "ParseJson"
                                },
                                "Set_TranslatorTaskComments": {
                                    "inputs": {
                                        "name": "TranslatorTaskComments",
                                        "value": "@body('Parse_Task_Translation_Status_JSON')?['TASMUTaskStatusInternal']"
                                    },
                                    "runAfter": {
                                        "Set_TranslatorTaskStatus": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "SetVariable"
                                },
                                "Set_TranslatorTaskStatus": {
                                    "inputs": {
                                        "name": "TranslatorTaskStatus",
                                        "value": "@body('Parse_Task_Translation_Status_JSON')?['Translation']"
                                    },
                                    "runAfter": {
                                        "Parse_Task_Translation_Status_JSON": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "SetVariable"
                                }
                            },
                            "expression": "@equals(variables('TranslatorTaskStatus'), 'Finish Translation')",
                            "limit": {
                                "count": 3000,
                                "timeout": "P1M"
                            },
                            "runAfter": {
                                "Send_an_email_(V2)_Translation_Request_Notification": [
                                    "Succeeded"
                                ]
                            },
                            "type": "Until"
                        },
                        "Until_Task_Status_Is_Start_Translation": {
                            "actions": {
                                "Delay_10_Seconds_Start_Translation": {
                                    "inputs": {
                                        "interval": {
                                            "count": 10,
                                            "unit": "Second"
                                        }
                                    },
                                    "runAfter": {},
                                    "type": "Wait"
                                },
                                "Get_Translation_Status_And_Ownership": {
                                    "inputs": {
                                        "body": {
                                            "headers": {
                                                "Accept": "application/json;odata=nometadata",
                                                "Content-Type": "application/json"
                                            },
                                            "method": "GET",
                                            "uri": "/_api/web/Lists/getbytitle('@{parameters('MyTasksList')}')/items(@{body('Parse_Users_Task_For_Translation_JSON')?['ID']})?$select=Editor/Id,Translation&$expand=Editor/Id"
                                        },
                                        "host": {
                                            "connection": {
                                                "name": "@parameters('$connections')['apicon-cpd-apps-intspo-tst-we-01']['connectionId']"
                                            }
                                        },
                                        "method": "post",
                                        "path": "/datasets/@{encodeURIComponent(encodeURIComponent(body('Parse_Service_Bus_Message_JSON')?['SiteURL']))}/httprequest"
                                    },
                                    "runAfter": {
                                        "Delay_10_Seconds_Start_Translation": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "ApiConnection"
                                },
                                "Parse_Translation_Status_And_Ownership_JSON": {
                                    "inputs": {
                                        "content": "@body('Get_Translation_Status_And_Ownership')",
                                        "schema": {
                                            "properties": {
                                                "Editor": {
                                                    "properties": {
                                                        "Id": {
                                                            "type": "integer"
                                                        }
                                                    },
                                                    "type": "object"
                                                },
                                                "Translation": {
                                                    "type": [
                                                        "string",
                                                        "null"
                                                    ]
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "runAfter": {
                                        "Get_Translation_Status_And_Ownership": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "ParseJson"
                                },
                                "Set_TranslationOwnership": {
                                    "inputs": {
                                        "name": "TranslationOwnership",
                                        "value": "@{body('Parse_Translation_Status_And_Ownership_JSON')?['Translation']}"
                                    },
                                    "runAfter": {
                                        "Set_TranslationOwnershipEmail": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "SetVariable"
                                },
                                "Set_TranslationOwnershipEmail": {
                                    "inputs": {
                                        "name": "TranslationOwnershipEmail",
                                        "value": "@{body('Parse_Translation_Status_And_Ownership_JSON')?['Editor']?['Id']}"
                                    },
                                    "runAfter": {
                                        "Parse_Translation_Status_And_Ownership_JSON": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "SetVariable"
                                }
                            },
                            "expression": "@equals(or(equals(variables('TranslationOwnership'), 'Start Translation'), equals(variables('TranslationOwnershipCompleted'), 'Yes')), true)",
                            "limit": {
                                "count": 2900,
                                "timeout": "P1M"
                            },
                            "runAfter": {
                                "Send_an_email_(V2)_Translation_Request_Notification": [
                                    "Succeeded"
                                ]
                            },
                            "type": "Until"
                        },
                        "Until_Task_Status_is_Start_Translation_Reminder": {
                            "actions": {
                                "Delay_1_Day_Start_Translation_Reminder": {
                                    "inputs": {
                                        "interval": {
                                            "count": 1,
                                            "unit": "Day"
                                        }
                                    },
                                    "runAfter": {},
                                    "type": "Wait"
                                },
                                "If_TranslationOwnershipCompleted_Start_Translation": {
                                    "actions": {
                                        "Send_an_email_(V2)_Translation_Request_Reminder": {
                                            "inputs": {
                                                "body": {
                                                    "Body": "<p>@{variables('EmailBody')}</p>",
                                                    "Subject": "Gentle Reminder-Translation Request - @{body('Parse_Service_Bus_Message_JSON')?['ItemTitle']}",
                                                    "To": "@variables('TranslatorsEmail')"
                                                },
                                                "host": {
                                                    "connection": {
                                                        "name": "@parameters('$connections')['apicon-cpd-apps-into365-tst-we-01']['connectionId']"
                                                    }
                                                },
                                                "method": "post",
                                                "path": "/v2/Mail"
                                            },
                                            "runAfter": {},
                                            "type": "ApiConnection"
                                        }
                                    },
                                    "expression": {
                                        "or": [
                                            {
                                                "equals": [
                                                    "@variables('StartTranslationReminder')",
                                                    "@true"
                                                ]
                                            }
                                        ]
                                    },
                                    "runAfter": {
                                        "Delay_1_Day_Start_Translation_Reminder": [
                                            "Succeeded"
                                        ]
                                    },
                                    "type": "If"
                                }
                            },
                            "expression": "@equals(variables('StartTranslationReminder'), false)",
                            "limit": {
                                "count": 100,
                                "timeout": "P1M"
                            },
                            "runAfter": {
                                "Send_an_email_(V2)_Translation_Request_Notification": [
                                    "Succeeded"
                                ]
                            },
                            "type": "Until"
                        },
                        "Update_Item_Status_To_Pending_Translation": {
                            "inputs": {
                                "body": {
                                    "body": "{\n\"ContentStatus\":\"Pending Translation\",\n\"RequiresTranslation\":\"false\"\n}",
                                    "headers": {
                                        "Accept": "application/json;odata=nometadata",
                                        "Content-Type": "application/json",
                                        "If-Match": "*",
                                        "X-HTTP-Method": "MERGE"
                                    },
                                    "method": "POST",
                                    "uri": "/_api/web/lists/GetByTitle('@{body('Parse_Service_Bus_Message_JSON')?['ListName']}')/GetItemById(@{body('Parse_Service_Bus_Message_JSON')?['ItemId']})"
                                },
                                "host": {
                                    "connection": {
                                        "name": "@parameters('$connections')['apicon-cpd-apps-intspo-tst-we-01']['connectionId']"
                                    }
                                },
                                "method": "post",
                                "path": "/datasets/@{encodeURIComponent(encodeURIComponent(body('Parse_Service_Bus_Message_JSON')?['SiteURL']))}/httprequest"
                            },
                            "runAfter": {
                                "Parse_Users_Task_For_Translation_JSON": [
                                    "Succeeded"
                                ]
                            },
                            "type": "ApiConnection"
                        }
                    },
                    "expression": {
                        "and": [
                            {
                                "equals": [
                                    "@length(body('Parse_Items_From_Task_List_JSON')?['value'])",
                                    0
                                ]
                            },
                            {
                                "equals": [
                                    "@length(body('Parse_Items_From_Global_Level_Task_List_JSON')?['value'])",
                                    0
                                ]
                            }
                        ]
                    },
                    "runAfter": {
                        "Check_For_Document_Or_Picture_Library": [
                            "Succeeded"
                        ]
                    },
                    "type": "If"
                },
                "Initialize_EditorEmailBody": {
                    "inputs": {
                        "variables": [
                            {
                                "name": "EditorEmailBody",
                                "type": "string"
                            }
                        ]
                    },
                    "runAfter": {
                        "Initialize_EmailBody": [
                            "Succeeded"
                        ]
                    },
                    "type": "InitializeVariable"
                },
                "Initialize_EmailBody": {
                    "inputs": {
                        "variables": [
                            {
                                "name": "EmailBody",
                                "type": "string"
                            }
                        ]
                    },
                    "runAfter": {
                        "Initialize_TranslationOwnershipEmail": [
                            "Succeeded"
                        ]
                    },
                    "type": "InitializeVariable"
                },
                "Initialize_FinishTranslationReminder": {
                    "inputs": {
                        "variables": [
                            {
                                "name": "FinishTranslationReminder",
                                "type": "boolean",
                                "value": "@true"
                            }
                        ]
                    },
                    "runAfter": {
                        "Initialize_StartTranslationReminder": [
                            "Succeeded"
                        ]
                    },
                    "type": "InitializeVariable"
                },
                "Initialize_IncrementVariableForUntilLoop": {
                    "inputs": {
                        "variables": [
                            {
                                "name": "IncrementVariableForUntilLoop",
                                "type": "integer",
                                "value": 0
                            }
                        ]
                    },
                    "runAfter": {
                        "Initialize_NumberOfColumnsToTranslate": [
                            "Succeeded"
                        ]
                    },
                    "type": "InitializeVariable"
                },
                "Initialize_ListName": {
                    "inputs": {
                        "variables": [
                            {
                                "name": "ListName",
                                "type": "string"
                            }
                        ]
                    },
                    "runAfter": {
                        "Initialize_TranslatedPlainTextstring": [
                            "Succeeded"
                        ]
                    },
                    "type": "InitializeVariable"
                },
                "Initialize_NumberOfColumnsToTranslate": {
                    "inputs": {
                        "variables": [
                            {
                                "name": "NumberOfColumnsToTranslate",
                                "type": "integer"
                            }
                        ]
                    },
                    "runAfter": {
                        "Initialize_FinishTranslationReminder": [
                            "Succeeded"
                        ]
                    },
                    "type": "InitializeVariable"
                },
                "Initialize_StartTranslationReminder": {
                    "inputs": {
                        "variables": [
                            {
                                "name": "StartTranslationReminder",
                                "type": "boolean",
                                "value": "@true"
                            }
                        ]
                    },
                    "runAfter": {
                        "Initialize_EditorEmailBody": [
                            "Succeeded"
                        ]
                    },
                    "type": "InitializeVariable"
                },
                "Initialize_TranslateColumnsString": {
                    "inputs": {
                        "variables": [
                            {
                                "name": "TranslateColumnsString",
                                "type": "string"
                            }
                        ]
                    },
                    "runAfter": {
                        "Initialize_IncrementVariableForUntilLoop": [
                            "Succeeded"
                        ]
                    },
                    "type": "InitializeVariable"
                },
                "Initialize_TranslatedHTMLstring": {
                    "inputs": {
                        "variables": [
                            {
                                "name": "TranslatedHTML",
                                "type": "string",
                                "value": "@{trim('')}"
                            }
                        ]
                    },
                    "runAfter": {
                        "Initialize_TranslatedObject": [
                            "Succeeded"
                        ]
                    },
                    "type": "InitializeVariable"
                },
                "Initialize_TranslatedObject": {
                    "inputs": {
                        "variables": [
                            {
                                "name": "TranslatedObject",
                                "type": "object"
                            }
                        ]
                    },
                    "runAfter": {
                        "Initialize_TranslateColumnsString": [
                            "Succeeded"
                        ]
                    },
                    "type": "InitializeVariable"
                },
                "Initialize_TranslatedPlainTextstring": {
                    "inputs": {
                        "variables": [
                            {
                                "name": "TranslatedPlain",
                                "type": "string",
                                "value": "@{trim('')}"
                            }
                        ]
                    },
                    "runAfter": {
                        "Initialize_TranslatedHTMLstring": [
                            "Succeeded"
                        ]
                    },
                    "type": "InitializeVariable"
                },
                "Initialize_TranslationContentTypeId": {
                    "inputs": {
                        "variables": [
                            {
                                "name": "TranslationContentTypeId",
                                "type": "string"
                            }
                        ]
                    },
                    "runAfter": {
                        "Initialize_TranslatorsUserId": [
                            "Succeeded"
                        ]
                    },
                    "type": "InitializeVariable"
                },
                "Initialize_TranslationOwnership": {
                    "inputs": {
                        "variables": [
                            {
                                "name": "TranslationOwnership",
                                "type": "string"
                            }
                        ]
                    },
                    "runAfter": {
                        "Initialize_TranslationContentTypeId": [
                            "Succeeded"
                        ]
                    },
                    "type": "InitializeVariable"
                },
                "Initialize_TranslationOwnershipCompleted": {
                    "inputs": {
                        "variables": [
                            {
                                "name": "TranslationOwnershipCompleted",
                                "type": "string"
                            }
                        ]
                    },
                    "runAfter": {
                        "Initialize_TranslatorTaskComments": [
                            "Succeeded"
                        ]
                    },
                    "type": "InitializeVariable"
                },
                "Initialize_TranslationOwnershipEmail": {
                    "inputs": {
                        "variables": [
                            {
                                "name": "TranslationOwnershipEmail",
                                "type": "string"
                            }
                        ]
                    },
                    "runAfter": {
                        "Initialize_TranslationOwnershipCompleted": [
                            "Succeeded"
                        ]
                    },
                    "type": "InitializeVariable"
                },
                "Initialize_TranslatorTaskComments": {
                    "inputs": {
                        "variables": [
                            {
                                "name": "TranslatorTaskComments",
                                "type": "string"
                            }
                        ]
                    },
                    "runAfter": {
                        "Initialize_TranslatorTaskStatus": [
                            "Succeeded"
                        ]
                    },
                    "type": "InitializeVariable"
                },
                "Initialize_TranslatorTaskStatus": {
                    "inputs": {
                        "variables": [
                            {
                                "name": "TranslatorTaskStatus",
                                "type": "string"
                            }
                        ]
                    },
                    "runAfter": {
                        "Initialize_TranslationOwnership": [
                            "Succeeded"
                        ]
                    },
                    "type": "InitializeVariable"
                },
                "Initialize_TranslatorsEmail": {
                    "inputs": {
                        "variables": [
                            {
                                "name": "TranslatorsEmail",
                                "type": "string"
                            }
                        ]
                    },
                    "runAfter": {},
                    "type": "InitializeVariable"
                },
                "Initialize_TranslatorsUserId": {
                    "inputs": {
                        "variables": [
                            {
                                "name": "TranslatorsUserId",
                                "type": "array"
                            }
                        ]
                    },
                    "runAfter": {
                        "Initialize_TranslatorsEmail": [
                            "Succeeded"
                        ]
                    },
                    "type": "InitializeVariable"
                },
                "Parse_Items_From_Global_Level_Task_List_JSON": {
                    "inputs": {
                        "content": "@body('Get_Items_From_Global_Level_Task_List')",
                        "schema": {
                            "properties": {
                                "value": {
                                    "items": {
                                        "properties": {
                                            "ID": {
                                                "type": "integer"
                                            },
                                            "Id": {
                                                "type": "integer"
                                            },
                                            "ParentItemId": {
                                                "type": "string"
                                            }
                                        },
                                        "required": [
                                            "Id",
                                            "ParentItemId",
                                            "ID"
                                        ],
                                        "type": "object"
                                    },
                                    "type": "array"
                                }
                            },
                            "type": "object"
                        }
                    },
                    "runAfter": {
                        "Parse_Items_From_Task_List_JSON": [
                            "Succeeded"
                        ]
                    },
                    "type": "ParseJson"
                },
                "Parse_Items_From_Task_List_JSON": {
                    "inputs": {
                        "content": "@body('Get_Items_From_Task_List')",
                        "schema": {
                            "properties": {
                                "value": {
                                    "items": {
                                        "properties": {
                                            "ID": {
                                                "type": "integer"
                                            },
                                            "Id": {
                                                "type": "integer"
                                            },
                                            "ParentItemId": {
                                                "type": "string"
                                            }
                                        },
                                        "required": [
                                            "Id",
                                            "ParentItemId",
                                            "ID"
                                        ],
                                        "type": "object"
                                    },
                                    "type": "array"
                                }
                            },
                            "type": "object"
                        }
                    },
                    "runAfter": {
                        "Get_Items_From_Global_Level_Task_List": [
                            "Succeeded"
                        ]
                    },
                    "type": "ParseJson"
                },
                "Parse_Service_Bus_Message_JSON": {
                    "inputs": {
                        "content": "@decodeBase64(triggerBody()?['ContentData'])",
                        "schema": {
                            "properties": {
                                "ChangeType": {
                                    "type": [
                                        "string",
                                        "null"
                                    ]
                                },
                                "EditorEmail": {
                                    "type": "string"
                                },
                                "GlobalConfigList": {
                                    "type": "string"
                                },
                                "GlobalSiteTitle": {
                                    "type": [
                                        "string",
                                        "null"
                                    ]
                                },
                                "GlobalSiteURL": {
                                    "type": "string"
                                },
                                "ItemGUID": {
                                    "type": "string"
                                },
                                "ItemId": {
                                    "type": "string"
                                },
                                "ItemTitle": {
                                    "type": "string"
                                },
                                "ListId": {
                                    "type": "string"
                                },
                                "ListName": {
                                    "type": "string"
                                },
                                "MarketplaceSiteURL": {
                                    "type": "string"
                                },
                                "Sensitivity": {
                                    "type": [
                                        "string",
                                        "null"
                                    ]
                                },
                                "SiteURL": {
                                    "type": "string"
                                }
                            },
                            "type": "object"
                        }
                    },
                    "runAfter": {
                        "Initialize_ListName": [
                            "Succeeded"
                        ]
                    },
                    "type": "ParseJson"
                }
            }
        },
        "workflowParameters": {
            "value": {
                "$connections": {
                    "defaultValue": {},
                    "type": "Object"
                },
                "MyTasksList": {
                    "defaultValue": "My Tasks",
                    "type": "String"
                },
                "TranslateConfigListName": {
                    "defaultValue": "TranslateConfig",
                    "type": "String"
                }
            }
        },
        "tags": {
            "value": {
                "Environment": "Test"
            }
        },
        "connectionParameters": {
            "value": {
                "$connections": {
                    "value": {
                        "apicon-cpd-apps-into365-tst-we-01": {
                            "connectionId": "/subscriptions/d0694def-b27e-4bb7-900d-437fbeb802da/resourceGroups/rg-cpd-apps-int-tst-we-01/providers/Microsoft.Web/connections/apicon-cpd-apps-into365-tst-we-01",
                            "connectionName": "apicon-cpd-apps-into365-tst-we-01",
                            "id": "/subscriptions/d0694def-b27e-4bb7-900d-437fbeb802da/providers/Microsoft.Web/locations/westeurope/managedApis/office365"
                        },
                        "apicon-cpd-apps-intsb-tst-we-01": {
                            "connectionId": "/subscriptions/d0694def-b27e-4bb7-900d-437fbeb802da/resourceGroups/rg-cpd-apps-int-tst-we-01/providers/Microsoft.Web/connections/apicon-cpd-apps-intsb-tst-we-01",
                            "connectionName": "apicon-cpd-apps-intsb-tst-we-01",
                            "id": "/subscriptions/d0694def-b27e-4bb7-900d-437fbeb802da/providers/Microsoft.Web/locations/westeurope/managedApis/servicebus"
                        },
                        "apicon-cpd-apps-intspo-tst-we-01": {
                            "connectionId": "/subscriptions/d0694def-b27e-4bb7-900d-437fbeb802da/resourceGroups/rg-cpd-apps-int-tst-we-01/providers/Microsoft.Web/connections/apicon-cpd-apps-intspo-tst-we-01",
                            "connectionName": "apicon-cpd-apps-intspo-tst-we-01",
                            "id": "/subscriptions/d0694def-b27e-4bb7-900d-437fbeb802da/providers/Microsoft.Web/locations/westeurope/managedApis/sharepointonline"
                        },
                        "apicon-cpd-apps-intcog-tst-we-01": {
                            "connectionId": "/subscriptions/d0694def-b27e-4bb7-900d-437fbeb802da/resourceGroups/rg-cpd-apps-int-tst-we-01/providers/Microsoft.Web/connections/apicon-cpd-apps-intcog-tst-we-01",
                            "connectionName": "apicon-cpd-apps-intcog-tst-we-01",
                            "id": "/subscriptions/d0694def-b27e-4bb7-900d-437fbeb802da/providers/Microsoft.Web/locations/westeurope/managedApis/translatorv2"
                        }
                    }
                }
            }
        }
    }
}